angular.module("casino-lights",[]),angular.module("casino-lights").directive("casinoLights",["$timeout","$q","$filter","casino.font-service",function(t,n,o,i){function e(n,e,r,a,c){function l(){o(n.config.filter)(n.word,s++),f()}function f(){n.config.power&&(n.animatePromise=t(l,n.config.speed))}function u(){s=0,t.cancel(n.animatePromise),angular.forEach(n.word,function(t){angular.forEach(t.lights,function(t){t.power=!1},this)})}var s=0;n.config=angular.extend({speed:100,filter:"random",power:!0,letters:c().text(),font:window.getComputedStyle(e[0]).getPropertyValue("font-family").split(",")[0].replace(/"/g,"").toLowerCase()},n.config),n.word=[],i.fetch(n.config,function(t){return angular.forEach(n.config.letters,function(o){n.word.push({"char":o,lights:angular.copy(t[o])})})}),n.$watch("config.filter",function(){n.animatePromise&&u(),f()}),n.$watch("config.power",function(t,n){t&&!n?f():!t&&n&&u()}),e.on("$destroy",function(){t.cancel(n.animatePromise)})}function r(){return['<span ng-repeat="letter in word track by $index" data-content="{{letter.char}}">',"{{letter.char}}",'<i ng-repeat="light in letter.lights" class="light" ng-class="{on:light.power}"',"    ng-style=\"{'left':light.left + '%', 'bottom':light.bottom + '%'}\">","</i>","</span>"].join("")}return{restrict:"A",scope:{text:"@",config:"=?"},link:e,transclude:!0,template:r}}]),angular.module("casino-lights").config(["$filterProvider","$provide",function(t,n){var o=t.register,i=[];t.register=function(t,n){i.push(t),o(t,n)},n.value("filters",i)}]),angular.module("casino-lights").filter("letter",function(){return function(t,n){var o=8,i=Math.floor(n%(t.length*o)/o),e=t[i],r=i>0?t[i-1]:t[t.length-1];angular.forEach(e.lights,function(t){t.power=!0},this),angular.forEach(r.lights,function(t){t.power=!1},this)}}),angular.module("casino-lights").filter("random",function(){return function(t,n){n%8===0&&angular.forEach(t,function(t){angular.forEach(t.lights,function(t){t.power=Math.random()>.5?!0:!1},this)},this)}}),angular.module("casino-lights").filter("vertical",function(){return function(t,n){var o=100,i=3,e=n%o,r=Math.round(e/o)?!1:!0,a=e*i,c=o+(50-e)*i;angular.forEach(t,function(t){angular.forEach(t.lights,function(t){r&&t.bottom<a&&(t.power=!0),!r&&t.bottom>c&&(t.power=!1)},this)},this)}}),angular.module("casino-lights").service("casino.font-service",["$q","$injector",function(t,n){this.fetch=function(t,o){try{return o(n.get("casino."+t.font))}catch(i){throw"Font data not found for font:"+t.font+",\nPlease check data file exists: http://github.com/thatguynamedandy/angular-casino-lights"}}}]);