angular.module("casino-lights",[]),angular.module("casino-lights").directive("casinoLights",["$timeout","$q","$filter","casino.font-service",function(t,n,o,a){function i(n,i){function e(){o(n.config.filter)(n.word,l++),r()}function r(){n.config.power&&(n.animatePromise=t(e,n.config.speed))}function c(){l=0,t.cancel(n.animatePromise),angular.forEach(n.word,function(t){angular.forEach(t.lights,function(t){t.power=!1},this)})}var l=0;n.config=angular.extend({speed:100,filter:"random",power:!0,letters:n.text,dataPath:"app/bower_components/angular-casino-lights/js/data/",font:window.getComputedStyle(i[0]).getPropertyValue("font-family").split(",")[0].toLowerCase()},n.config),n.word=[],a.fetch(n.config,function(t){return angular.forEach(n.config.letters,function(o){n.word.push({"char":o,lights:t[o]})})}),n.$watch("config.filter",function(){n.animatePromise&&c(),r()}),n.$watch("config.power",function(t,n){t&&!n?r():!t&&n&&c()}),i.on("$destroy",function(){t.cancel(n.animatePromise)})}function e(){return['<span ng-repeat="letter in word track by $index" data-content="{{letter.char}}">',"{{letter.char}}",'<i ng-repeat="light in letter.lights" class="light" ng-class="{on:light.power}"','    style="left:{{light.left}}%;bottom:{{light.bottom}}%">',"</i>","</span>"].join("")}return{restrict:"A",scope:{text:"@",config:"=?"},link:i,template:e}}]),angular.module("casino-lights").service("casino.font-service",["$q","$http","$injector","$log",function(t,n,o,a){this.fetch=function(t,i){try{return i(o.get("casino."+t.font))}catch(e){a.info("Asyncronously Loading data for "+t.font+": Recommended that you bootstrap data into page"),n({method:"GET",url:t.dataPath+t.font+".json",cache:!0}).success(i).error(function(){throw"Font data not found for font:"+t.font+",\nPlease check data file exists: http://github.com/thatguynamedandy/angular-casino-lights"})}}}]),angular.module("casino-lights").config(function(t,n){var o=t.register,a=[];t.register=function(t,n){a.push(t),o(t,n)},n.value("filters",a)}),angular.module("casino-lights").filter("letter",function(){return function(t,n){var o=8,a=Math.floor(n%(t.length*o)/o),i=t[a],e=a>0?t[a-1]:t[t.length-1];angular.forEach(i.lights,function(t){t.power=!0},this),angular.forEach(e.lights,function(t){t.power=!1},this)}}),angular.module("casino-lights").filter("random",function(){return function(t,n){n%8===0&&angular.forEach(t,function(t){angular.forEach(t.lights,function(t){t.power=Math.random()>.5?!0:!1},this)},this)}}),angular.module("casino-lights").filter("vertical",function(){return function(t,n){var o=100,a=3,i=n%o,e=Math.round(i/o)?!1:!0,r=i*a,c=o+(50-i)*a;angular.forEach(t,function(t){angular.forEach(t.lights,function(t){e&&t.bottom<r&&(t.power=!0),!e&&t.bottom>c&&(t.power=!1)},this)},this)}});